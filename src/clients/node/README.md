This file is generated by
[src/clients/docs_generate.zig](/src/clients/docs_generate.zig).

# tigerbeetle-node

The TigerBeetle client for Node.js.

## Installation

```bash
printf 'require("tigerbeetle-node"); console.log("SUCCESS!");' > test.js
npm install tigerbeetle-node
node run
```

## Creating a Client

```javascript
const client = createClient({
  cluster_id: 0,
  replica_addresses: ['3001', '3002', '3003']
});
```



The following are valid addresses:
* `3000` (interpreted as `127.0.0.1:3000`)
* `127.0.0.1:3000` (interpreted as `127.0.0.1:3000`)
* `127.0.0.1` (interpreted as `127.0.0.1:3001`, `3001` is the default port)

## Creating Accounts

See details for account fields in the [Accounts
reference](https://docs.tigerbeetle.com/reference/accounts).

```javascript
const account = {
  id: 137n, // u128
  user_data: 0n, // u128, opaque third-party identifier to link this account to an external entity:
  reserved: Buffer.alloc(48, 0), // [48]u8
  ledger: 1,   // u32, ledger value
  code: 718, // u16, a chart of accounts code describing the type of account (e.g. clearing, settlement)
  flags: 0,  // u16
  debits_pending: 0n,  // u64
  debits_posted: 0n,  // u64
  credits_pending: 0n, // u64
  credits_posted: 0n, // u64
  timestamp: 0n, // u64, Reserved: This will be set by the server.
};

const errors = await client.createAccounts([account]);
if (errors.length) {
  // Grab a human-readable message from the response
  console.log(CreateAccountError[errors[0].code]);
}
```



### Account Flags

The account flags value is a bitfield. See details for
these flags in the [Accounts
reference](https://docs.tigerbeetle.com/reference/accounts#flags).

To toggle behavior for an account, combine enum values stored in the
`AccountFlags` object (in TypeScript it is an actual enum) with
bitwise-or:

* `AccountFlags.linked`
* `AccountFlags.debits_must_not_exceed_credits`
* `AccountFlags.credits_must_not_exceed_credits`

For example, to link `account0` and `account1`, where `account0`
additionally has the `debits_must_not_exceed_credits` constraint:

```js
const account0 = { ... account values ... };
const account1 = { ... account values ... };
account0.flags = AccountFlags.linked | AccountFlags.debits_must_not_exceed_credits;
// Create the account
const errors = client.createAccounts([account0, account1]);
```

### Response and Errors

The response is an empty array if all accounts were
created successfully. If the response is non-empty, each
object in the response array contains error information
for an account that failed. The error object contains an
error code and the index of the account in the request
batch.

## Account Lookup

Account lookup is batched, like account creation. Pass
in all IDs to fetch, and matched accounts are returned.

If no account matches an ID, no object is returned for
that account. So the order of accounts in the response is
not necessarily the same as the order of IDs in the
request. You can refer to the ID field in the response to
distinguish accounts.

```javascript
// account 137n exists, 138n does not
const accounts = await client.lookupAccounts([137n, 138n]);
/* console.log(accounts);
 * [{
 *   id: 137n,
 *   user_data: 0n,
 *   reserved: Buffer,
 *   ledger: 1,
 *   code: 718,
 *   flags: 0,
 *   debits_pending: 0n,
 *   debits_posted: 0n,
 *   credits_pending: 0n,
 *   credits_posted: 0n,
 *   timestamp: 1623062009212508993n,
 * }]
 */
```

## Development Setup

### On Linux and macOS

```bash
npm install --include dev # This will automatically install and build everything you need.
```

### On Windows

```powershell
npm install --include dev # This will automatically install and build everything you need.
```

